<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Data Science con R: Fundamentos y Aplicaciones</title>
  <meta name="description" content="El mejor libro en espanol de ciencia de datos, libre y abierto.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Data Science con R: Fundamentos y Aplicaciones" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/BEST/DSFA/" />
  
  <meta property="og:description" content="El mejor libro en espanol de ciencia de datos, libre y abierto." />
  <meta name="github-repo" content="BESTDATASCIENCE/DATA-SCIENCE-CON-R-FUNDAMENTOS-Y-APLICACIONES" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Science con R: Fundamentos y Aplicaciones" />
  
  <meta name="twitter:description" content="El mejor libro en espanol de ciencia de datos, libre y abierto." />
  

<meta name="author" content="BEST: Behavioral Economics &amp; Data Science Team">


<meta name="date" content="2019-02-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="analisis-exploratorio.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science con R:: Fundamentos y Aplicaciones</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>¡Bienvenidos!</a></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i>Introducción</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#intro-for-students"><i class="fa fa-check"></i>Introducción para estudiantes</a><ul>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#que-aprendere-de-este-libro"><i class="fa fa-check"></i>¿Qué aprenderé de este libro?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html#about-authors"><i class="fa fa-check"></i>Acerca del autor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="prefacio.html"><a href="prefacio.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="" data-path="motivacion.html"><a href="motivacion.html"><i class="fa fa-check"></i>Motivación</a><ul>
<li class="chapter" data-level="" data-path="motivacion.html"><a href="motivacion.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="motivacion.html"><a href="motivacion.html#agradecimientos"><i class="fa fa-check"></i>Agradecimientos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#data-science"><i class="fa fa-check"></i><b>1.1</b> Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#r-y-rstudio"><i class="fa fa-check"></i><b>1.2</b> R y RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#instalacion-de-r-y-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Instalación de R y RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#usando-r-con-rstudio"><i class="fa fa-check"></i><b>1.2.2</b> Usando R con RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#git-y-github"><i class="fa fa-check"></i><b>1.3</b> Git y Github</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html"><i class="fa fa-check"></i><b>2</b> Limpieza de Datos</a><ul>
<li class="chapter" data-level="2.1" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#principios-de-limpieza-de-datos"><i class="fa fa-check"></i><b>2.1</b> Principios de Limpieza de datos</a></li>
<li class="chapter" data-level="2.2" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#principales-problemas-con-base-de-datos-sucias"><i class="fa fa-check"></i><b>2.2</b> Principales problemas con base de datos sucias</a><ul>
<li class="chapter" data-level="2.2.1" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#las-columnas-son-valores-y-no-nombres-de-valores"><i class="fa fa-check"></i><b>2.2.1</b> Las columnas son valores y no nombres de valores</a></li>
<li class="chapter" data-level="2.2.2" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#multipes-variables-estan-almacenadas-en-una-columna"><i class="fa fa-check"></i><b>2.2.2</b> Múltipes variables están almacenadas en una columna</a></li>
<li class="chapter" data-level="2.2.3" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#variables-estan-almacenadas-en-filas-y-columnas"><i class="fa fa-check"></i><b>2.2.3</b> Variables están almacenadas en filas y columnas</a></li>
<li class="chapter" data-level="2.2.4" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#multipes-tipos-de-unidades-observacionales-estan-almacenadas-en-la-misma-tabla"><i class="fa fa-check"></i><b>2.2.4</b> Múltipes tipos de unidades observacionales están almacenadas en la misma tabla</a></li>
<li class="chapter" data-level="2.2.5" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#una-sola-unidad-observacional-esta-almacenada-en-multiples-tablas"><i class="fa fa-check"></i><b>2.2.5</b> Una sola unidad observacional está almacenada en múltiples tablas</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#casuisticas"><i class="fa fa-check"></i><b>2.3</b> Casuísticas</a><ul>
<li class="chapter" data-level="2.3.1" data-path="limpieza-de-datos.html"><a href="limpieza-de-datos.html#limpiando-data-de-banco-en-la-sbs"><i class="fa fa-check"></i><b>2.3.1</b> Limpiando data de banco en la SBS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analisis-exploratorio.html"><a href="analisis-exploratorio.html"><i class="fa fa-check"></i><b>3</b> Análisis Exploratorio</a></li>
<li class="chapter" data-level="4" data-path="analisis-inferencial.html"><a href="analisis-inferencial.html"><i class="fa fa-check"></i><b>4</b> Análisis Inferencial</a></li>
<li class="chapter" data-level="5" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>5</b> Machine Learning</a></li>
<li class="chapter" data-level="6" data-path="comunicando-resultados.html"><a href="comunicando-resultados.html"><i class="fa fa-check"></i><b>6</b> Comunicando Resultados</a></li>
<li class="chapter" data-level="7" data-path="temas-suplementarios.html"><a href="temas-suplementarios.html"><i class="fa fa-check"></i><b>7</b> Temas suplementarios</a></li>
<li class="chapter" data-level="8" data-path="contribute.html"><a href="contribute.html"><i class="fa fa-check"></i><b>8</b> ¿Deseas contribuir en el libro?</a></li>
<li class="chapter" data-level="9" data-path="cite.html"><a href="cite.html"><i class="fa fa-check"></i><b>9</b> Citando este libro</a></li>
<li class="divider"></li>
<li><a href="http://besteamperu.org/" target="blank">Creado por BEST</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science con R: Fundamentos y Aplicaciones</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="limpieza-de-datos" class="section level1">
<h1><span class="header-section-number">Capítulo 2</span> Limpieza de Datos</h1>
<p>La limpieza de datos es la parte dentro del proceso de la Ciencia de Datos que consume más tiempo. De acuerdo al paper de Dasu and Johnson (2003), el 80% del tiempo se consume en limpieza de datos.</p>
<p>¿Cómo aprender a limpiar data? Así como se aprende un nuevo lenguaje (alemán, francés, chino,etc), es necesario una cantidad importante de práctica y conocer los principios de la limpieza de datos</p>
<div id="principios-de-limpieza-de-datos" class="section level2">
<h2><span class="header-section-number">2.1</span> Principios de Limpieza de datos</h2>
<p>Los principios de limpieza de datos proveen un estándar para limpiar la data para no reinventar la rueda cada vez que tratamos de limpiar base de datos. La idea de la bases de datos limpias es hacer el análisis de datos más fácil, permitiendo enfocarnos en entender el problema y no la logística de la data.</p>
<p>Una base de datos limpia tiene las siguientes características:</p>
<ul>
<li>Cada variable forma una columna.</li>
<li>Cada observación forma una fila.</li>
<li>Cada tipo de unidad observacional forma una tabla.</li>
</ul>
</div>
<div id="principales-problemas-con-base-de-datos-sucias" class="section level2">
<h2><span class="header-section-number">2.2</span> Principales problemas con base de datos sucias</h2>
<p>Si bien cada de base de datos tiene sus propias particularidades, existen casos clásicos que lo veremos ahora, de tal forma el estudiante puede identificar los problemas y desarrollar la forma más eficiente de limpiar esa base de datos.</p>
<div id="las-columnas-son-valores-y-no-nombres-de-valores" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Las columnas son valores y no nombres de valores</h3>
</div>
<div id="multipes-variables-estan-almacenadas-en-una-columna" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Múltipes variables están almacenadas en una columna</h3>
</div>
<div id="variables-estan-almacenadas-en-filas-y-columnas" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Variables están almacenadas en filas y columnas</h3>
</div>
<div id="multipes-tipos-de-unidades-observacionales-estan-almacenadas-en-la-misma-tabla" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Múltipes tipos de unidades observacionales están almacenadas en la misma tabla</h3>
</div>
<div id="una-sola-unidad-observacional-esta-almacenada-en-multiples-tablas" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Una sola unidad observacional está almacenada en múltiples tablas</h3>
</div>
</div>
<div id="casuisticas" class="section level2">
<h2><span class="header-section-number">2.3</span> Casuísticas</h2>
<p>Una parte vital cuando uno aprende a lidiar con base de datos, es haciendo ejercicios. A continuación se brindará casuísticas y se le invitará al estudiante a desarrollarlas. En el mismo documento se encuentran los solucionarios respectivos.</p>
<div id="limpiando-data-de-banco-en-la-sbs" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Limpiando data de banco en la SBS</h3>
<p>La tarea consiste en descargar un excel de indicadores financieros del sistema bancario de junio 2018 y crear un dataframe limpio. Durante este ejemplo está prohibido descargar manualmente el excel. El respectivo excel se puede descargar desde la web de la <a href="http://www.sbs.gob.pe/app/stats_net/stats/EstadisticaBoletinEstadistico.aspx?p=1#">SBS</a> y luego accediendo a la pestaña, indicadores de las empresas bancarias y finalmente la opción Indicadores financieros.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Objetivo: Descargar 1 archivo de la SBS ####</span>
<span class="co">#configura tu directorio de trabajo, es decir, donde deseas trabajar</span>
<span class="kw">setwd</span>(<span class="st">&quot;~/Caso SBS/&quot;</span>)
<span class="co">#copia la url de tu interés</span>
fileUrl &lt;-<span class="st">  &quot;http://intranet2.sbs.gob.pe/estadistica/financiera/2018/Junio/B-2401-jn2018.XLS&quot;</span>
<span class="co">#usemos ?download.file para saber más de esta función</span>
<span class="co"># probemos primero el caso por default</span>
<span class="kw">download.file</span>(fileUrl,<span class="dt">destfile=</span><span class="st">&quot;archivo malo.XLS&quot;</span>)
<span class="co"># probemos ahora con el wb</span>
<span class="kw">download.file</span>(fileUrl,<span class="dt">destfile=</span><span class="st">&quot;archivo bueno.XLS&quot;</span>,<span class="dt">mode=</span><span class="st">&quot;wb&quot;</span>)
<span class="co"># ¿Por qué no funciona en el primer caso? A leer la documentación! Para archivos excel, es necesario descargarlo en modo wb.</span>

a&lt;-readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&quot;B-2401-jn2018.xls&quot;</span>) <span class="co"># carguemos la data. Conoce más del paquete usando ?readxl</span>
?readxl
<span class="kw">View</span>(a)

<span class="co"># 2 Objetivo: Limpiar la data ####</span>
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(tidyr)

a&lt;-readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&quot;B-2401-en2018.xls&quot;</span>,<span class="dt">skip =</span> <span class="dv">5</span>) <span class="co">#quitamos 5 espacios</span>
<span class="kw">View</span>(a)
a&lt;-a[<span class="kw">complete.cases</span>(a),] <span class="co"># solo elegimos filas completas (sin vacios)</span>
<span class="kw">View</span>(a)
<span class="kw">options</span>(<span class="dt">scipen=</span><span class="dv">999</span>) <span class="co"># para desactivar la nomenclatura cientifica de números</span>
<span class="kw">View</span>(a)
<span class="kw">names</span>(a)
<span class="kw">names</span>(a)[<span class="dv">10</span>] <span class="co">#seleccionamos el valor 10</span>
a&lt;-a[,<span class="op">-</span><span class="dv">10</span>] <span class="co"># quitamos la columna 10 #usa dplyr. Como ejercicio recuerda usar &quot;-&quot; y select</span>


<span class="kw">names</span>(a)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;variables&quot;</span>, <span class="st">&quot;BBVA&quot;</span>,<span class="st">&quot;B. del Comercio&quot;</span>, <span class="st">&quot;BCP&quot;</span>,
             <span class="st">&quot;Pichincha&quot;</span>,<span class="st">&quot;BIF&quot;</span>,<span class="st">&quot;Scotiabank&quot;</span>,
             <span class="st">&quot;Citibank&quot;</span>,<span class="st">&quot;Interbank&quot;</span>,<span class="st">&quot;Mibanco&quot;</span>,
             <span class="st">&quot;GNB&quot;</span>,<span class="st">&quot;Falabella&quot;</span>,<span class="st">&quot;Santander&quot;</span>,<span class="st">&quot;Ripley&quot;</span>,<span class="st">&quot;Azteca&quot;</span>,<span class="st">&quot;Cencosud&quot;</span>,<span class="st">&quot;ICBC&quot;</span>,
             <span class="st">&quot;Total Empresas Financieras&quot;</span>)
<span class="kw">View</span>(a)

exc =<span class="st"> </span><span class="op">!</span><span class="kw">names</span>(a) <span class="op">%in%</span><span class="st"> &quot;variables&quot;</span> <span class="co"># una forma de elegir todo excepto una columna de un vector</span>
exc <span class="co"># va a aplicar todo excepto a la primera columna</span>
a[,exc] <span class="co"># ven? no aparece la columns &quot;variables&quot;</span>
a[,exc] =<span class="st"> </span><span class="kw">sapply</span>(a[,exc],as.character) <span class="co"># lo convierto a character. Es buena practica convertir siempre a character tus datos numéricos y luego pasarlos a numeric recién. ¿Por qué? Porque a veces por alguna razón te puede salir tipo factor o character y tener problemas y no darte cuenta hasta el proceso de modelacion </span>
a[,exc] =<span class="st"> </span><span class="kw">sapply</span>(a[,exc],as.numeric) <span class="co"># lo convierto a numérico</span>
a[,exc] =<span class="st"> </span><span class="kw">round</span>(a[,exc],<span class="dv">2</span>) <span class="co">#redondeo a 2 cifras</span>
<span class="kw">View</span>(a)

a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">View</span>()
a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(Bancos) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">View</span>()
a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(Bancos,valores) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">View</span>()
a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(Bancos,valores,<span class="op">-</span>variables) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">View</span>()
b&lt;-a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(Bancos,valores,<span class="op">-</span>variables)
b <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(variables,valores) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">View</span>()
data.final&lt;-b <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(variables,valores)
data.final<span class="op">$</span>Periodo=<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-08-31&quot;</span>)
data.final
<span class="kw">View</span>(data.final)
<span class="co"># Objetivo: Guardar la data ####</span>

<span class="kw">saveRDS</span>(data.final,<span class="dt">file=</span><span class="st">&quot;midatalimpia.RDS&quot;</span>)</code></pre></div>
<p>¡Próximamente podrás utilizar más ejercicios para practicar este skill tan importante con data real de la SBS, SMV, INEI, BCRP, mensajes presindenciales y muchas otras fuentes!</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analisis-exploratorio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-limpieza.Rmd",
"text": "Edit"
},
"download": ["DSFA.pdf", "DSFA.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
